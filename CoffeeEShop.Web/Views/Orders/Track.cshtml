@model CoffeeEShop.Domain.DomainModels.Order

@{
    ViewBag.Title = "Track My Order";
}

<h2>Track Order #@Model.Id</h2>

<p>
    Current Status: <span id="order-status">@Model.Status</span>
</p>

<p>Created At: @Model.CreatedAt.ToString("g")</p>

<script>
    const orderId = '@Model.Id';
    const pollInterval = 10000; 

    async function fetchStatus() {
        try {
            const res = await fetch(`/api/orders/${orderId}`);
            if (!res.ok) return;
            const data = await res.json();
            document.getElementById('order-status').innerText = data.status;
        } catch (err) {
            console.error('Failed to fetch order status', err);
        }
    }

    // Poll every 10 seconds
    setInterval(fetchStatus, pollInterval);

    // Initial fetch
    fetchStatus();
</script>
